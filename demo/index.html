<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <script src="../build/index.js"></script>
        <style>
            .hidden{
                display:none;
            }
            .show{
                display:inline-block;
            }
        </style>
    </head>
    
    <body>
        <h1>DOCX browser Word document generation</h1>

        <button id="generate" type="button" onclick="generate()">Click to generate</button>

        <script>
            function generate(){
                const doc = new docx.DocXBuilder();
                const a = new docx.Var('a', {inform: '变量', unit: docx.unit('m')});
                const b = new docx.Var('b');
                const c = new docx.Var('c');
                const d = new docx.Var('d');
                const ref = new docx.Reference('表');

                b.value = 2;
                c.value = 1;
                a.value = (b.value+c.value)*c.value;
                const exp = (b.add(c)).mul(c);
                doc.heading(1,'hello');
                doc.heading(2,'hello2');
                doc.paragraph('hello world');
                doc.paragraphBuilder()
                .text('world hello')
                .footnote('reversed')
                .formula(a, exp)
                .text('按照')
                .reference(ref)
                .text(',可以计算得到:')
                .variableValue(a)
                .text('计算过程如下：')
                .formulaValue(a, exp);

                const fm = (b.add(c).add(b)).mul(c).div(b); 
                const def = doc.mathDefinitionBuilder();
                def.formula(a, fm);
                const prd = doc.mathProcedureBuilder();
                prd.formula(a, fm);

                doc.paragraphBuilder()
                .text('计算用表')

                doc.mathDeclarationBuilder()
                .declare(a);

                console.log('begin def2');
                const fm2 = docx.sin(b);
                const def2 = doc.mathDefinitionBuilder();
                def2.formula(a, fm2);
                console.log('finish def2');
                a.value = fm2.Value;
                const prd2 = doc.mathProcedureBuilder();
                prd2.formula(a, fm2);

                doc.tableBuilder(2, ref)
                .title('计算结果表')
                .rowData('深度', '高度')
                .rowData('1', '2')
                .rowData('3', '4')
                doc.saveBlob('test.docx')
            }

        </script>
    </body>
</html>